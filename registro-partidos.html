<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Registro de Partidos</title>
    <link rel="icon" type="image/svg+xml" href="favicon.svg">
	<link rel="icon" href="favicon.ico">
<link rel="apple-touch-icon" href="faviapple.jpg">

<link rel="manifest" href="manifest.json">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
	    <link href="https://fonts.googleapis.com/css2?family=Syne:wght@400;600;700;800&family=DM+Sans:wght@400;500;700&display=swap" rel="stylesheet">

   <link rel="stylesheet" href="css/styles-common.css">
    <link rel="stylesheet" href="css/styles-registro.css">
	    <link rel="stylesheet" href="css/bottom-nav.css">

    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
   <script>
        // Verificar sesi√≥n activa
        if (!sessionStorage.getItem('xisco_session_active')) {
            window.location.href = 'index.html';
        }
    </script>
	
</head>
<body>
    <div class="container">
		<!-- Header -->
<div class="page-header">
    <div class="header-content-wrapper">
        <div class="header-text">
            <h1>Registrar Partidos</h1>
            <p>Almacena toda la informaci√≥n sobre tus partidos</p>
        </div>
        <div class="header-image">
            <img src="/pool/images/banner.png" alt="Xisco">
        </div>
    </div>
</div>
      

        <div id="successMessage" style="display: none;"></div>

        <div class="main-card1">
            <div style="text-align: center; margin-bottom: 20px; padding: 0 16px;">
                <h2 class="section-title" style="margin-bottom: 16px;">Importar desde Excel</h2>
                <p style="color: #000; margin-bottom: 20px; font-size: 0.95rem;">
                    Importa m√∫ltiples partidos desde un archivo Excel (.xlsx, .xls, .csv)
                </p>
                
                <!-- Info desplegable -->
                <div class="info-collapsible">
                    <button class="info-toggle" onclick="toggleInfo('excelInfo')">
                        <span class="info-icon">?</span>
                        <span>Formato del archivo</span>
                        <span class="chevron" id="excelInfoChevron">‚ñº</span>
                    </button>
                    <div class="info-content" id="excelInfo">
                        <div class="info-content-inner">
                            <p style="color: #86868b; font-size: 0.9rem; margin-bottom: 12px;">El archivo debe tener las siguientes columnas (en cualquier orden):</p>
                            <ul>
                                <li><strong>Rival</strong> o <strong>Jugador 2</strong> - Nombre del oponente</li>
                                <li><strong>Partidas Xisco</strong> o <strong>Score1</strong> - Partidas ganadas por Xisco</li>
                                <li><strong>Partidas Rival</strong> o <strong>Score2</strong> - Partidas ganadas por el rival</li>
                                <li><strong>Material</strong> - Material usado por Xisco</li>
                                <li><strong>Modalidad</strong> - Bola 8, Bola 9 o Bola 10</li>
                                <li><strong>Fecha</strong> - Fecha del partido (formato: DD/MM/YYYY o YYYY-MM-DD)</li>
                            </ul>
                        </div>
                    </div>
                </div>

                <label for="excelFileInput" class="btn btn-primary1" style="cursor: pointer; display: inline-block; margin-top: 20px;">
                    Seleccionar archivo Excel
                </label>
                <input type="file" id="excelFileInput" accept=".xlsx,.xls,.csv" style="display: none;">
                
                <div id="importPreview" style="display: none; margin-top: 20px;"></div>
            </div>
        </div>

        <div class="main-card">
            <form id="matchForm">
                <h2 class="section-title" id="formTitle" style="text-align: center; margin-bottom: 32px;">Registrar Nuevo Partido</h2>
                
                <div class="form-section">
                    <h2 class="section-title">Jugadores</h2>
                    <div class="form-row">
                        <div class="form-group">
                            <label>XISCO</label>
                            <input type="text" value="Xisco" readonly>
                        </div>
                        <div class="form-group">
                            <label>RIVAL</label>
                            <input type="text" id="player2" placeholder="Nombre del rival" required>
                        </div>
                    </div>
                </div>

                <div class="form-section">
                    <h2 class="section-title">Resultado</h2>
                    <div class="score-inputs">
                        <div class="form-group">
                            <label>Partidas Xisco</label>
                            <input type="number" id="score1" min="0" placeholder="0" required>
                        </div>
                        <div class="score-label">-</div>
                        <div class="form-group">
                            <label>Partidas Rival</label>
                            <input type="number" id="score2" min="0" placeholder="0" required>
                        </div>
                    </div>
                </div>

                <div class="form-section">
                    <h2 class="section-title">Material de Xisco</h2>
                    <div class="material-chips" id="materialChips"></div>
                    <div class="add-material-input">
                        <input type="text" id="newMaterial" placeholder="A√±adir nuevo material">
                        <button type="button" class="btn-add-material" onclick="addMaterial()">+</button>
                    </div>
                </div>

                <div class="form-section">
                    <div class="form-row">
                        <div class="form-group">
                            <label>Modalidad</label>
                            <select id="modality" required>
                                <option value="">Seleccionar modalidad</option>
                                <option value="Bola 8">Bola 8</option>
                                <option value="Bola 9">Bola 9</option>
                                <option value="Bola 10">Bola 10</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Fecha</label>
                            <input type="date" id="matchDate" required>
                        </div>
                    </div>
                </div>

                <div class="actions">
                    <button type="submit" class="btn btn-primary ">Crear Partido</button>
                    <button type="button" class=" btn-secondary" onclick="resetForm()">‚ü≥ Limpiar</button>
                </div>
            </form>
        </div>

        <div class="main-card history-card">
            <div class="history-header">
                <h2 class="section-title" style="margin: 0;">Estad√≠sticas externas por Modalidad</h2>
                <button class="btn-secondary" style="padding: 10px 20px; border-radius: 8px;" onclick="toggleModalityEdit()">
                    ‚úèÔ∏è <span id="editBtnText">Editar</span>
                </button>
            </div>
            
            <div style="background: rgba(0, 0, 0, 0.01); border: 1px solid rgba(0, 0, 0, 0.011); border-radius: 12px; padding: 20px; margin-bottom: 20px;">
                <p style="color: #86868b; font-size: 0.9rem; margin-bottom: 12px;">
                    <strong style="color: #000000;">üìä Sincronizaci√≥n autom√°tica:</strong> A√±ade datos de plataforma externas para que se sumen a las importadas. Puedes editarlos manualmente para a√±adir partidos adicionales no registrados en el sistema.
                </p>
            </div>

            <div class="modality-stats-grid" id="modalityStatsSection"></div>
        </div>

        <div class="main-card history-card">
            <div class="history-header">
                <h2 class="section-title">Historial de Partidos</h2>
                <div class="history-actions">
                    <button class="btn-secondary destacado" onclick="syncToGitHub()" title="Subir a Cloud">
                        ‚Üë Guardar
                    </button>
                  
					<button class="btn-secondary"  onclick="location.reload()"  title="Refrescar p√°gina"> 
						‚ü≥ Refrescar
					</button>
                    <button class="btn-secondary" onclick="downloadData()" title="Descargar JSON">
                        ‚§ì JSON
                    </button>
                    <button class="btn-danger" onclick="resetAllData()" title="Reiniciar">
                        ‚úï Reset
                    </button>
                </div>
            </div>
            
            <!-- Controles de paginaci√≥n superior -->
            <div id="paginationTop" class="pagination-container" style="display: none;"></div>
            
            <div id="matchHistory" class="match-list"></div>
            
            <!-- Controles de paginaci√≥n inferior -->
            <div id="paginationBottom" class="pagination-container" style="display: none;"></div>
        </div>
    </div>
<script src="js/cloud-sync.js"></script>
	 <script src="js/registro.js"></script>
 <script src="js/common.js"></script>
   <script src="js/top-nav.js"></script>
	<script src="js/bottom-nav.js"></script>
</body>
</html>
